同学们好，欢迎来到密码学、身份鉴别和访问控制这门课程，我是主讲人陆成刚，大家可以通过 luedge@163.com 联系我，我的手机是 15397011231。
在正式开始学习之前，我们先来了解一下这门课程的内容架构。课程主要包含访问控制、身份鉴别，它们底层依赖公钥密码、生物特征等技术基础。就像真假美猴王的故事，只有如来和谛听能分辨，这和我们的身份鉴别技术很相似，需要依靠特定的 “能力” 或 “技术” 来准确区分。同时，大家可以扫描群二维码加入课程群，方便后续交流学习。
接下来，让我们走进密码学的历史长河。最早接触到的是 Caesar 密码，它的原理很简单，是一种移位密码。我们令 P（明文空间） = C（密文空间） = K（密钥空间） = Z₂₆ ，对于 0 ≤ K ≤ 25 ，任意 x, y ∈ Z₂₆，定义加密函数 eₖ(x) = (x + K) mod 26 ，解密函数 dₖ(x) = (y - K) mod 26 。比如输入明文 “Hello world! I'm LeiJun, Are you ok?” ，密钥为 4，加密后得到 “Lipps asvph! M'q PimNyr, Evi csy so?” ，解密后又能还原回原明文。那如何破解 Caesar 密码呢？利用字母出现频率的不变规则就可以。在正常的英文文本中，某些字母出现的频率较高，如 “e”“t” 等，通过统计密文中字母的频率，与正常频率对比，就能推测出密钥。
1583 年发明的 Vigenere 密码，在 1867 年被破解。它的加密文法用同余形式表示为 Cᵢ ≡ Pᵢ + Kᵢ (mod 26) ，解密方法是 Pᵢ = Cᵢ - Kᵢ (mod 26) 。破解它需要先估计密钥长度，再进行频率分析。1923 年发明的 Hill 密码，是史上第一个利用矩阵的密码，密码系统表示为 C = E (K, P) = KP mod 26 ，P = D (K, C) = K⁻¹C mod 26 = K⁻¹KP = P 。
Base64 编码是基于 64 个可打印字符来表示二进制数据的字节码，在 Web 开发里非常重要。解码时，要先将字符串转为二进制，从前至后每 8 个二进制进行 chr () 操作，直到不足 8 位。还要注意大小端问题。Enigma 密码用于加密的部件包括插线板、转子和反射板，每个部件都能将明文字符转换为密文字符，可抽象表示为一个 0 - 25 的全排列，定义了一一映射。中国还有传统汉字密码编码，像藏头诗，以及近代电报编码，1872 年丹麦大北公司《电报新书》设 4 位数字对 1 个汉字，收发双方通过在原来数字基础进行加减设密；曾纪泽《电句集锦》，李凤苞的 3 字母编码 26 * 26 * 26 ，扣除 6 千常用字后，一万作常用句。比如 “艳电”，在近代史中，它特指汪兆铭于 1938 年 12 月 29 日由林柏生代为发表致蒋介石的电报式声明，支持对日妥协政策，这是因为电报费昂贵，人们为省字用日期编码来表示。
了解完历史，我们来综述一下密码学。密码学的安全目标包含机密性、完整性、抗抵赖、可用性等。涉及的安全领域有平台安全，像物理安全、网络安全、系统安全等；安全技术包括防火墙技术、漏洞扫描技术等；安全理论有密码理论，涵盖数据加密、数字签名等。密码学有五大核心功能：保密性、身份鉴别、完整性、不可抵赖性、密钥交换 。在密码学中，明文通过加密算法和密钥变成密文，即 C = Eₖ(P) ，密文又能通过解密算法和密钥还原成明文，P = Dₖ(C) 。这里有个重要的 Kerckhoffs 原则，1883 年柯克霍夫斯提出加密算法应建立在算法公开不影响明文和密钥安全的基础上，这是判定密码强度的衡量标准，也是古典密码和现代密码的分界线。
密码学还有一些重要概念，比如前向保密性，指泄漏不应该被传播，过去泄漏的信息不影响后来的消息；完善保密性，用公式表示为 Pr [Y = y|X = x] 的计算是所有能满足 x = dₖ(y) 的密钥 k 的概率之和。一次一密就满足完善保密性，它只用异或运算，实现简单、效率高，唯密文攻击无效，但分发和存储长密钥困难，密钥至少和明文一样长，且必须是真随机的。Vernam 于 1900 年代申请美国专利，美苏冷战时双方首脑的热线使用了这种理论，它也是量子（密钥）通信的基础。在一次一密中，密钥等概率分布时，密文也等概，此时明文也等概，并且可以进一步推广，只要明文与密钥独立就可满足完善保密性，M、K、C 任意两者确定第三者，也满足完善保密性。
密码学面临多种攻击方式。选择明文攻击是指知道加密算法，且选定明文可知对应的密文，攻击者目标是推出加密算法中的密钥 K ；选择密文攻击是指攻击者利用解密算法，对自己所选的密文解密出相应的明文；唯密文攻击是只知道密文，通过统计特性分析规律；已知明文攻击是得到了一些给定的明文和对应的密文；选择密钥攻击指攻击方了解各种密钥之间的关系；软磨硬泡攻击是攻击方通过软磨硬泡获得密钥；自适应选择明文攻击是密码分析者不仅能选择被加密的明文，还能依据以前加密结果对选择进行修正。
密码算法主要分为对称密码体制、公钥密码体制和 Hash 函数。对称密码体制用于保密，像 DES 算法、3DES 算法、AES 算法、RC4 算法、SEAL 算法等；公钥密码体制用于身份鉴别、不可抵赖性、密钥交换，如 RSA 算法、EIGamal 算法；Hash 函数是单向函数、数字指纹、用于保证信息完整性。
我们再深入了解一下公钥密码系统。1976 年 DH 密钥交换协议开启了现代密码学的开端，爱丽丝和鲍伯协商一个有限循环群 G 和它的一个生成元 g ，爱丽丝选择随机自然数 a 并将 gᵃ mod p 发送给鲍伯，鲍伯选择随机自然数 b 并将 gᵇ mod p 发送给爱丽丝，爱丽丝计算 (gᵇ)ᵃ mod p ，鲍伯计算 (gᵃ)ᵇ mod p ，他们就协商出共享秘密 gᵃᵇ 。1977 年 RSA 公钥密码系统发明，它基于数论知识。我们先了解一些预备知识，比如素数阶有限域，Z/7 - {0} = {1, 2, 3, 4, 5, 6} 关于乘法模 7 形成一个 6 阶循环群，Z/7 = {0, 1, 2, 3, 4, 5, 6} 关于加法构成加法群，Z/7 关于加法和乘法构成一个 7 阶有限域。还有费马小定理，p 大素数，g 与 p 互素，则 gᵖ⁻¹ = 1 (mod p) ；欧拉定理，设 φ(n) 为 n 的欧拉数，数 a 满足 (a, n) = 1 则 a^φ(n) = 1 (mod n) 。RSA 原理是考虑 p、q 为两素数，令 n = pq ，则 φ(n) = (p - 1)(q - 1) ，设 1 ≤ x ≤ n - 1 ，令 1 < e ≤ φ(n) - 1 且 (e, φ(n)) = 1 ，即存在 d ，满足 ed + φ(n) u = 1 ，则 xᵈ = x^φ(n)⁻¹ = x (mod n) 。比如 p = 3 ，q = 5 ，n = 15 ，则 φ(n) = 8 ，e = 7 ，因为 7×15 + 8×(-13) = 1 ，于是 d = 15 ，设明文 x = 13 ，密文 13⁷ = 7mod15 ，解密 7¹⁵ ≡ 13mod15 。
RSA 是确定型算法，称为 TextbookRSA 教科书式 RSA，它不满足完善保密性，容易受到选择密文攻击，根据密文 xᵉ可以生成 (2x)ᵉ 。随机填充型 RSA 实际上也不满足 “完善保密性”。RSA 密钥生成需要选取大素数 p、q ，选取 d 与 (q - 1)(p - 1) 互素，再求 e 满足 de + (p - 1)(q - 1) = 1 ，即 de = 1mod (p - 1)(q - 1) 。计算时可以使用二进制指数快速运算，这样能防止整数溢出，这也是第一次作业的一部分内容。第一次作业还有实现一个 TOY 级公钥密码的加解密算法，A 版本，明文密文皆为 2k + 1 位长的十进制正整数，加密是对明文 x ，取 xU 的 2k + 1 位记为 c ，解密是对密文 c ，取 cV 的 2k + 1 位得到 x ，大家要考虑成立的理由、安全性分析以及代码实现，注意 k > 3 时可能造成 int 变量溢出，要思考如何实现大数乘法。
最后，我们来看一下 RSA 破解记录。随着时间推移，不同位数的 RSA 数被陆续破解，从早期的 RSA - 100 到后来的 RSA - 2048 等，破解难度随着位数增加而增大，这也反映出 RSA 算法安全性与密钥长度的关系，位数越高，破解难度越大，安全性相对越高。希望大家通过今天的学习，对密码学有初步的认识，课后认真完成作业，加深对知识的理解和掌握。
